/*! scratchjs - v0.0.3dev1 - 2013-06-02 */
var Scratch={};Scratch.Enum={MouseMove:"mousemove",MouseOver:"mouseover",MouseOut:"mouseout",MouseDown:"mousedown",MouseUp:"mouseup",MouseDragMove:"mousedragmove",MouseDragOver:"mousedragover",MouseDragOut:"mousedragout",MouseDrop:"mousedrop",WidgetTypeNone:"none",WidgetTypeBoard:"board",WidgetTypeNode:"node",WidgetTypeDock:"dock",DockInput:"dockinput",DockOutput:"dockoutput",SVG:{Circle:"circle",Rect:"rect",Path:"path"}},Scratch.API={},Scratch.Util=function(){function t(t){var e;return e=document.createElementNS("http://www.w3.org/2000/svg","circle"),e.setAttribute("id",t.id),e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",t.r),e.setAttribute("style",t.style),e}function e(t){var e;return e=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.setAttribute("id",t.id),e.setAttribute("x",t.x),e.setAttribute("y",t.y),e.setAttribute("width",t.w),e.setAttribute("height",t.h),e.setAttribute("style",t.style),e}function c(t){var e;return e=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.setAttribute("id",t.id),e.setAttribute("d",t.d),e.setAttribute("style",t.style),e}function r(r,s,n){var i;return s==Scratch.Enum.SVG.Circle?(i=t(n),r.appendChild(i)):s==Scratch.Enum.SVG.Rect?(i=e(n),r.appendChild(i)):s==Scratch.Enum.SVG.Path&&(i=c(n),r.appendChild(i)),i}function s(t){var e=t.parentNode;e.removeChild(t)}return{SVG:{add:r,remove:s}}}(),Scratch.StatusMachine=function(t){if(void 0!==t&&null!==t){(void 0===t.scratch||null===t.scratch)&&(t.scratch={}),t.scratch.statusmachine=this;var e=this;t.onmouseup=function(){e.unset()},this._root=t,this._objs=[],this._current=void 0}},Scratch.StatusMachine.prototype={set:function(t){this._current=t},unset:function(){void 0!==this._current&&(this._current.setAttribute("pointer-events","all"),delete this._current)},interest:function(t){this._objs.push(t)},disinterest:function(t){for(var e=0;this._objs.length>e;++e)this._objs[e]==t&&this._objs.splice(e,0)}},Scratch.API.CreateStatusMachine=function(t){return void 0===t||null===t?void 0:((void 0===t.scratch||null===t.scratch)&&(t.scratch={}),void 0!==t.scratch.statusmachine?t.scratch.statusmachine:new Scratch.StatusMachine(t))},Scratch.API.DestroyStatusMachine=function(t){void 0!==t&&null!==t&&void 0!==t.scratch&&(void 0!==t.scratch.statusmachine&&delete t.scratch.statusmachine,delete t.scratch)},Scratch.Event=function(t,e){void 0!==t&&null!==t&&void 0!==e&&null!==e&&(void 0===t.scratch&&(t.scratch={}),t.scratch.event=this,t.onmousemove=function(e){var c=Scratch.Enum.MouseMove;void 0!==t.scratch.event._sm._current&&(c=Scratch.Enum.MouseDragMove);var r=this.scratch.event._evts[c];void 0!==r&&r(e,this.scratch.event._sm)},t.onmouseover=function(e){var c=Scratch.Enum.MouseOver;void 0!==t.scratch.event._sm._current&&(c=Scratch.Enum.MouseDragOver);var r=this.scratch.event._evts[c];void 0!==r&&r(e,this.scratch.event._sm)},t.onmouseout=function(e){var c=Scratch.Enum.MouseOut;void 0!==t.scratch.event._sm._current&&(c=Scratch.Enum.MouseDragOut);var r=this.scratch.event._evts[c];void 0!==r&&r(e,this.scratch.event._sm)},t.onmousedown=function(t){var e=this.scratch.event._evts[Scratch.Enum.MouseDown];void 0!==e&&(e(t,this.scratch.event._sm),this.scratch.event._sm.set(this))},t.onmouseup=function(e){var c=Scratch.Enum.MouseUp;void 0!==t.scratch.event._sm._current&&(c=Scratch.Enum.MouseDrop);var r=this.scratch.event._evts[c];void 0!==r&&r(e,this.scratch.event._sm)},this._obj=t,this._sm=e,this._evts={})},Scratch.Event.prototype={interest:function(){return this._sm.interest(this._obj),this},disinterest:function(){return this._sm.disinsterest(this._obj),this},on:function(t,e){return void 0!==e&&null!==e?(this._evts[t]=e,this):void 0},off:function(t){var e=this._evts[t];if(void 0!==e)return delete this._evts[t],this},call:function(t,e){var c=this._evts[t];void 0!==c&&null!==c&&c(e)}},Scratch.API.CreateEvent=function(t,e){return void 0===t||null===t?void 0:(void 0===t.scratch&&(t.scratch={}),void 0!==t.scratch.event?t.scratch.event:new Scratch.Event(t,e))},Scratch.API.DestroyEvent=function(t){void 0!==t&&null!==t&&void 0!==t.scratch&&void 0!==t.scratch.event&&delete t.scratch.event},Scratch.Widget=function(t){function e(t){void 0===t.scratch&&(t.scratch={}),void 0===t.scratch.widget&&(t.scratch.widget={}),void 0===t.scratch.widget.type&&(t.scratch.widget.type=Scratch.Enum.WidgetTypeNone)}function c(t){delete t.scratch.widget}function r(t){return void 0===t?!1:void 0===t.scratch?!1:void 0===t.scratch.widget?!1:!0}return e(t),{type:function(){return r(t)?t.scratch.widget.type:Scratch.Enum.WidgetTypeNone},board:function(){t.scratch.widget.type=Scratch.Enum.WidgetTypeBoard},node:function(e){t.scratch.widget.type=Scratch.Enum.WidgetTypeNode,t.scratch.widget.node={},t.scratch.widget.node.board=e},dock:function(e,c){t.scratch.widget.type=Scratch.Enum.WidgetTypeDock,t.scratch.widget.dock={},t.scratch.widget.dock.node=e,t.scratch.widget.dock.type=c},empty:function(){c(t)}}},void 0===Scratch.API&&(Scratch.API={});